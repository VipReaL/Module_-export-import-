# Модули в JS

```
Модуль — обособленная часть системы. Как правило, один модуль — это один файл. Модули можно воспринимать, как части конструктора, из которых собирается программа.
```

Если тег __< script >__ подключать с атрибутом __type="module"__, стандартное восприятие браузером JS немного изменится.

## Область видимости

У модуля своя область видимости. Он содержит локальные переменные и функции, которые не загрязняют глобальную область. Но если они нужны где-то снаружи, их придётся экспортировать.

## Старые браузеры

В старых браузерах атрибута __type="module"__ не существует.  
Это можно обойти так: пишут отдельный код для старых браузеров и подключают отдельно. То есть дописывают ещё один тег __< script >__, а в его атрибут __type="nomodule"__. Но так поступают редко.

## Виды экспорта:

* ``export const array = [1, 2, 3]`` — именованный экспорт. В файле их может быть несколько;
* ``export { dog, cat }`` — сразу несколько сущностей можно экспортировать после их объявления.
* ``export { array as arr }`` — Экспорт с другим именем: директива __export as__. Переменные и функции можно переименовывать при экспорте, чтобы обращаться к методам модуля по новому имени.
* ``export default [12, 22, 31]`` — по умолчанию. Такой экспорт может быть только один в файле модуля. Имена дают экспортированным данным позже, уже при импорте (*import someArr from './data.js'*).

## Виды импорта:

* ``import { array } from './data.js'`` — с именем сущности. Импортировать объекты тоже можно пачками. Переменные, которые добавляются в модуль, нужно перечислить через запятую в фигурных скобках.
* ``import { array as arr } from './data.js'`` — с переименованием сущности;
* ``import data from './data.js'`` — по умолчанию. Фигурные скобки не нужны, имя даётся в момент импорта;
* ``import * as data from './data.js';`` — импорт всего содержимого сразу. Но так лучше не делать. Такой код сложнее читать: не видно, что конкретно импортируется из файла data.js.

## Должен быть прописан путь до файла.

```javascript
import user from 'user' // Неправильно...

// Должен быть либо абсолютный путь:
import user from 'https://some-site.com/js/user.js'

// ...Либо относительный:
import user from './user.js'
```

## Инкапсуляция

Это способ описывать функциональность объектом, а всю логику заключать в его внутренние методы. Так избавляются от глобальных переменных, а все нужные содержатся внутри его методов. Поэтому к ним можно спокойно обращаться снаружи.  
Такой объект и называют модулем:

```javascript
// Chart — модуль
const Chart = (function() {
  // локальные переменные, они не видны снаружи
  const data = [];
    
  // публичные методы, они будут доступны в объекте Chart
    return {
        render: function (data) { /* ... */ },
        setData: function (data) { /* ... */ }
    };
}()); // IIFE возвращает объект

Chart.render([[0,12], [1,22], [3,18]]);
```